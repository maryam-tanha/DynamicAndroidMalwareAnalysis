import os
import pandas as pd

# Step 1: Read the system calls from the .txt file and store them in a list
with open('unique_syscalls.txt', 'r') as syscall_file:
    syscalls = [line.strip() for line in syscall_file]

# Step 2: Read all CSV files from specific directories and create vectors
csv_directories = [
    '/home/mary/Documents/Extraction/benign-features/syscall-info-v1',
    '/home/mary/Documents/Extraction/malware-features/syscall-info-v1',
    '/home/mary/Documents/Extraction/benign-features/syscall-info-v2'
]

csv_vectors = []

# Use boolean flag to alternate between malware and benign vectors
malware_flag = False

for csv_directory in csv_directories:
    for filename in os.listdir(csv_directory):
        if filename.endswith(".csv"):
            file_path = os.path.join(csv_directory, filename)

            # Read CSV file into a DataFrame
            df = pd.read_csv(file_path)

            # Create a vector for the current CSV file
            vector = [filename, int(malware_flag)] + [
                df[df['Syscall'] == syscall]['Frequency'].values[0] if syscall in df['Syscall'].values else 0
                for syscall in syscalls
            ]

            # Append the vector to the list
            csv_vectors.append(vector)

    # Toggle the malware flag for the next iteration
    malware_flag = not malware_flag

# Step 3: Create a CSV file containing all the vectors
output_csv_filename = 'final_vectors.csv'
columns = ['File', 'Malware'] + syscalls
df = pd.DataFrame(csv_vectors, columns=columns)
df.to_csv(output_csv_filename, index=False)

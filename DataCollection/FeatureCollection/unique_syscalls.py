import os
import csv

# Create an empty set to store unique syscall names
unique_syscalls = set()

# Directory path containing the CSV files
directory_paths = [
    '/home/mary/Documents/Extraction/benign-features/syscall-info-v1',
    '/home/mary/Documents/Extraction/benign-features/syscall-info-v2',
    '/home/mary/Documents/Extraction/malware-features/syscall-info-v1'
]

for directory_path in directory_paths:
    # Iterate through all files in the directory
    for filename in os.listdir(directory_path):
        if filename.endswith(".csv"):
            file_path = os.path.join(directory_path, filename)
            #print(f"Reading data from {filename}...")

            # Open the CSV file and read the syscall column
            with open(file_path, 'r', newline='') as csvfile:
                csvreader = csv.DictReader(csvfile)
                for row in csvreader:
                    syscall = row.get('Syscall')  # Assuming the column header is 'syscall'
                    if syscall:
                        unique_syscalls.add(syscall)
    num_csv_files = len([filename for filename in os.listdir(directory_path) if filename.endswith(".csv")])
    print(f"Number of CSV files processed: {num_csv_files}")

# Path to the output text file
output_file_path = 'unique_syscalls.txt'

# Open the file in write mode and write each item from the set to a separate line
with open(output_file_path, 'w') as file:
    for syscall in unique_syscalls:
        file.write(syscall + '\n')


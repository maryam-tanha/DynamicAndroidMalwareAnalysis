import frida

def on_message(message, data):
    if message['type'] == 'send':
        print(message['payload'])

# Specify the package name or the APK path
package_name = "com.example.targetapp"

# Attach to the target APK
device = frida.get_usb_device()
pid = device.spawn([package_name])
session = device.attach(pid)

# Load the JavaScript code to intercept system calls
with open("script.js", "r") as script_file:
    script_code = script_file.read()

script = session.create_script(script_code)
script.on('message', on_message)
script.load()

# Resume the target APK execution
device.resume(pid)

# Keep the script running until interrupted
try:
    input("Press enter to exit...")
except KeyboardInterrupt:
    pass

# Clean up
device.kill(pid)
session.detach()
